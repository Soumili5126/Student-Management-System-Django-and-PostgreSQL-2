{% extends 'base.html' %}
{% block content %}

<h2 class="mb-4 fw-bold">Welcome!</h2>

<!-- ================= NAV TABS ================= -->
<ul class="nav nav-tabs mb-4">

    <li class="nav-item">
        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#profile">Profile</button>
    </li>

    <li class="nav-item">
        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#exams">Exams</button>
    </li>

    <li class="nav-item">
        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#subjects">Subjects & Students</button>
    </li>

    <li class="nav-item">
        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#quizzes">Quizzes</button>
    </li>

</ul>

<div class="tab-content">

    <!-- PROFILE -->
    <div class="tab-pane fade show active" id="profile">

        <div class="row">

            <!-- LEFT SIDE PROFILE -->
            <div class="col-md-8">

                <div class="text-center mb-3">
                    {% if request.user.profile_image %}
                        <img src="{{ request.user.profile_image.url }}"
                            class="rounded-circle shadow"
                            width="120"
                            height="120"
                            style="object-fit:cover;">
                    {% else %}
                        <img src="https://via.placeholder.com/120"
                            class="rounded-circle shadow">
                    {% endif %}
                </div>

                <div class="card p-4">
                    <h5 class="mb-3">Profile Information</h5>

                    <div class="row mb-2">
                        <div class="col-md-3 text-muted">Full Name</div>
                        <div class="col-md-9">{{ request.user.first_name }} {{ request.user.last_name }}</div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-3 text-muted">Username</div>
                        <div class="col-md-9">{{ faculty.user.username }}</div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-md-3 text-muted">Department</div>
                        <div class="col-md-9">{{ faculty.department }}</div>
                    </div>

                    <div class="row">
                        <div class="col-md-3 text-muted">Designation</div>
                        <div class="col-md-9">{{ faculty.designation }}</div>
                    </div>

                    <a href="{% url 'edit_faculty_profile' %}"
                       class="btn btn-primary mt-4">
                        Edit Profile
                    </a>
                </div>

            </div>

            <!-- RIGHT SIDE CALENDAR -->
            <div class="col-md-4">

                <div class="card p-3 shadow-sm">
                    <h6 class="text-center mb-3">Calendar</h6>
                    <div id="facultyCalendar"></div>
                </div>

            </div>

        </div>

    </div>

    <!-- EXAMS -->
    <div class="tab-pane fade" id="exams">

        {% if exams %}
            <div class="row">
                {% for exam in exams %}
                    <div class="col-md-6 mb-3">
                        <div class="card p-3">
                            <h6>{{ exam.course.code }}</h6>
                            <p class="mb-2 text-muted">{{ exam.title }}</p>
                            <a href="{% url 'enter_grades' exam.id %}"
                               class="btn btn-outline-primary btn-sm">
                               Enter Grades
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-muted">No exams created yet.</p>
        {% endif %}
    
    </div>

    <!-- SUBJECTS -->
    <div class="tab-pane fade" id="subjects">

        <div class="row">
        {% for item in course_data %}
            <div class="col-md-6 mb-4">
                <div class="card p-3">
                    <h6 class="mb-3">{{ item.course.code }} â€” {{ item.course.name }}</h6>

                    <p class="fw-semibold">Students Enrolled</p>

                    {% if item.enrollments %}
                        <ul class="mb-0">
                            {% for e in item.enrollments %}
                                <li>{{ e.student.user.first_name }} {{ e.student.user.last_name }}
                                    ({{ e.student.user.username }})</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-muted small">No students enrolled.</p>
                    {% endif %}
                </div>
            </div>
        {% empty %}
            <p>No courses assigned.</p>
        {% endfor %}
        </div>

    </div>

    <!-- QUIZZES -->
    <div class="tab-pane fade" id="quizzes">

        <div class="row">
        {% for item in course_data %}
            <div class="col-md-6 mb-4">
                <div class="card p-3">

                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6>{{ item.course.code }}</h6>
                        <a href="{% url 'create_quiz' item.course.id %}"
                           class="btn btn-sm btn-success">
                            Create
                        </a>
                    </div>

                    {% for quiz in item.quizzes %}
                        <div class="mb-3 p-2 border rounded">
                            <strong>{{ quiz.title }}</strong>
                            <div class="mt-2">
                                <a href="{% url 'add_quiz_question' quiz.id %}"
                                   class="btn btn-sm btn-outline-secondary">
                                    Add Questions
                                </a>

                                <a href="{% url 'faculty_quiz_analytics' quiz.id %}"
                                   class="btn btn-sm btn-outline-info">
                                    View Analytics
                                </a>
                            </div>
                        </div>
                    {% empty %}
                        <p class="text-muted small">No quizzes created.</p>
                    {% endfor %}

                </div>
            </div>
        {% endfor %}
        </div>

    </div>

</div>


<!-- FullCalendar CSS -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">

<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {

    var hash = window.location.hash;

    if (hash) {
        var triggerEl = document.querySelector('[data-bs-target="' + hash + '"]');
        if (triggerEl) {
            var tab = new bootstrap.Tab(triggerEl);
            tab.show();
        }
    }

 var calendarEl = document.getElementById('facultyCalendar');

if (calendarEl) {
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        height: 400,

        headerToolbar: {
            left: 'prev',
            center: 'title',
            right: 'next'
        },

        titleFormat: {
            year: 'numeric',
            month: 'long'
        },

        navLinks: false

    });

    calendar.render();
}
});
</script>
<style>

/* Force smaller month + year text */
.fc .fc-toolbar-title {
    font-size: 20px !important;   /* ðŸ‘ˆ adjust here */
    font-weight: 500 !important;
    line-height: 1.2 !important;
}

/* Optional: reduce space around header */
.fc .fc-toolbar {
    margin-bottom: 10px !important;
}

/* Optional: reduce arrow button size */
.fc .fc-button {
    padding: 3px 8px !important;
    font-size: 12px !important;
}
<>

/* Remove underline from ALL calendar links */
.fc a {
    text-decoration: none !important;
}

/* Remove underline from date numbers specifically */
.fc-daygrid-day-number {
    text-decoration: none !important;
    color: #333 !important;   /* ðŸ‘ˆ change to any color you want */
}

/* Prevent blue visited link color */
.fc-daygrid-day-number:visited {
    color: #333 !important;
}

/* Optional: remove hover blue */
.fc-daygrid-day-number:hover {
    color: #000 !important;
}

/* Remove underline from weekday names */
.fc-col-header-cell-cushion {
    text-decoration: none !important;
    color: #333 !important;   /* Change color here */
}

/* Remove underline from all calendar links safely */
.fc a {
    text-decoration: none !important;
}

/* Disable hover effect */
.fc-col-header-cell-cushion:hover {
    text-decoration: none !important;
}

</style>
{% endblock %}

