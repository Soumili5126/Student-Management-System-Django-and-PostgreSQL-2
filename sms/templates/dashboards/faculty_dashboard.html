
{% extends 'base.html' %}
{% block content %}

<h2>Faculty Dashboard</h2>

<div class="card mb-4">
    <div class="card-body">
        <p><strong>Name:</strong> {{ faculty.user.username }}</p>
        <p><strong>Department:</strong> {{ faculty.department }}</p>
        <p><strong>Designation:</strong> {{ faculty.designation }}</p>
    </div>
</div>
<h3 class="mt-4">Exams</h3>

{% if exams %}
    <ul class="list-group">
        {% for exam in exams %}
            <li class="list-group-item d-flex justify-content-between">
                <span>
                    {{ exam.course.code }} — {{ exam.name }}
                </span>

                <a href="{% url 'enter_grades' exam.id %}"
                   class="btn btn-sm btn-outline-primary">
                   Enter Grades
                </a>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p class="text-muted">No exams created yet.</p>
{% endif %}


{% for item in course_data %}
    <div class="card mb-4">
        <div class="card-header">
            <strong>{{ item.course.code }} — {{ item.course.name }}</strong>
        </div>

        <div class="card-body">
            <a href="{% url 'mark_attendance' item.course.id %}"
               class="btn btn-sm btn-primary mb-3">
                Mark Attendance
            </a>
            <a href="{% url 'create_quiz' item.course.id %}"
               class="btn btn-sm btn-outline-success mb-2">
                Create Quiz
            </a>
            <!-- ✅ ADD THIS BLOCK HERE -->
            <div class="mt-3">
                <h6>Quizzes</h6>

                {% for quiz in item.quizzes %}
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span>{{ quiz.title }}</span>

                        <a href="{% url 'add_quiz_question' quiz.id %}"
                            class="btn btn-sm btn-outline-secondary">
                            Add Questions
                        </a>
                    </div>
                {% empty %}
                    <p class="text-muted">No quizzes created yet.</p>
                {% endfor %}
            </div>

            <a href="{% url 'create_exam' item.course.id %}"
                class="btn btn-sm btn-success mb-3">
                Create Exam
            </a>
            

            <a href="{% url 'export_attendance' item.course.id %}"
               class="btn btn-sm btn-secondary mb-3 ms-2">
                Export Attendance
            </a>


            {% if item.enrollments %}
                <ul>
                    {% for e in item.enrollments %}
                        <li>
                            {{ e.student.user.username }}
                            <br>
                            <small class="text-muted">
                                Batch:
                                {% if e.student.batch %}
                                    {{ e.student.batch.program }} -
                                    {{ e.student.batch.name }}
                                    ({{ e.student.batch.academic_year }})
                                {% else %}
                                    Not Assigned
                                {% endif %}
                            </small>
                        </li>
                    {% endfor %}

                </ul>
            
            {% endif %}
        </div>
    </div>
{% empty %}
    <p>No courses assigned.</p>
{% endfor %}

{% endblock %}
